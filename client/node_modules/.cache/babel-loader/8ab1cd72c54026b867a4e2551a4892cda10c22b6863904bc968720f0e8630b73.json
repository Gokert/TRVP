{"ast":null,"code":"var _jsxFileName = \"/home/andrey/githubGokert/TRVP/client/src/Sobes.js\",\n  _s = $RefreshSig$();\nimport { CCol, CCardBody, CCard, CButton, CFormSelect } from '@coreui/react';\nimport { useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Sobes = ({\n  item,\n  loadSobeses,\n  specialists,\n  loadSpecialists,\n  spec\n}) => {\n  _s();\n  const [selectedSpecialist, setSelectedSpecialist] = useState('');\n  const [error, setError] = useState('');\n  const abilitiesPercents = (arr1, arr2) => {\n    let count = 0;\n    for (let index = 0; index < arr2.length; index++) {\n      const element = arr2[index];\n      if (arr1.includes(element)) {\n        count = count + 1;\n      }\n    }\n    console.log(count, arr1.length);\n    return count / arr1.length * 100;\n  };\n  const deleteSobes = () => {\n    fetch(`http://localhost:8080/api/sobes/${item.id}`, {\n      method: 'DELETE',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(result => {\n      loadSobeses();\n    });\n  };\n  const editSobes = () => {\n    fetch(`http://localhost:8080/api/specialist/${selectedSpecialist}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      return response.json();\n    }).then(data => {\n      if (abilitiesPercents(data.abilities.split(','), item.abilities.split(',')) < 80) {\n        setError('Недостаточно навыков');\n        return;\n      } else if (!(Number(data.time_start.split(':').join('')) <= Number(item.time_visit.split(':').join('')) && Number(data.time_finish.split(':').join('')) >= Number(item.time_visit.split(':').join('')))) {\n        setError('Время визита не попадает во время приёма');\n        return;\n      } else {\n        fetch(`http://localhost:8080/api/specialist_sobeses/${selectedSpecialist}`, {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        }).then(response => {\n          return response.json();\n        }).then(data => {\n          if (!!data.find(el => el.time_visit === item.time_visit)) {\n            setError('Время уже занято');\n            return;\n          }\n          const sobes = {\n            id: item.id,\n            fio: item.fio,\n            time_visit: item.time_visit,\n            abilities: item.abilities,\n            specialist_id: selectedSpecialist\n          };\n          fetch(`http://localhost:8080/api/sobes`, {\n            method: 'PUT',\n            body: JSON.stringify(sobes),\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          }).then(result => {\n            loadSpecialists();\n          });\n        });\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(CCol, {\n    xs: 4,\n    className: \"pb-3\",\n    children: /*#__PURE__*/_jsxDEV(CCard, {\n      children: /*#__PURE__*/_jsxDEV(CCardBody, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"\\u0424\\u0418\\u041E: \", item.fio]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u0432\\u0438\\u0437\\u0438\\u0442\\u0430: \", item.time_visit]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"\\u041D\\u0430\\u0432\\u044B\\u043A\\u0438: \", item.abilities]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(CFormSelect, {\n          label: \"\\u041A\\u0443\\u0434\\u0430 \\u043F\\u0435\\u0440\\u0435\\u043D\\u0435\\u0441\\u0442\\u0438?\",\n          onChange: e => {\n            setSelectedSpecialist(e.target.value);\n            setError('');\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \" \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 25\n          }, this), specialists.filter(el => el.id !== spec.id).map(specialist => {\n            return /*#__PURE__*/_jsxDEV(\"option\", {\n              value: specialist.id,\n              children: specialist.fio\n            }, specialist.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 37\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 21\n        }, this), !!error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-danger\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 33\n        }, this), /*#__PURE__*/_jsxDEV(CButton, {\n          className: \"mt-2 me-2\",\n          size: \"sm\",\n          onClick: () => editSobes(),\n          children: \"\\u041F\\u0435\\u0440\\u0435\\u043D\\u0435\\u0441\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(CButton, {\n          className: \"mt-2\",\n          size: \"sm\",\n          color: \"danger\",\n          onClick: () => deleteSobes(),\n          children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 9\n  }, this);\n};\n_s(Sobes, \"SpbVl2lVciqJAEHYVsb+7owvaCY=\");\n_c = Sobes;\nexport default Sobes;\nvar _c;\n$RefreshReg$(_c, \"Sobes\");","map":{"version":3,"names":["CCol","CCardBody","CCard","CButton","CFormSelect","useState","jsxDEV","_jsxDEV","Sobes","item","loadSobeses","specialists","loadSpecialists","spec","_s","selectedSpecialist","setSelectedSpecialist","error","setError","abilitiesPercents","arr1","arr2","count","index","length","element","includes","console","log","deleteSobes","fetch","id","method","headers","then","result","editSobes","response","json","data","abilities","split","Number","time_start","join","time_visit","time_finish","find","el","sobes","fio","specialist_id","body","JSON","stringify","xs","className","children","fileName","_jsxFileName","lineNumber","columnNumber","label","onChange","e","target","value","filter","map","specialist","size","onClick","color","_c","$RefreshReg$"],"sources":["/home/andrey/githubGokert/TRVP/client/src/Sobes.js"],"sourcesContent":["import { CCol, CCardBody, CCard, CButton, CFormSelect } from '@coreui/react';\nimport { useState } from 'react';\n\nconst Sobes = ({ item, loadSobeses, specialists, loadSpecialists, spec }) => {\n    const [selectedSpecialist, setSelectedSpecialist] = useState('');\n    const [error, setError] = useState('');\n\n    const abilitiesPercents = (arr1, arr2) => {\n        let count = 0;\n        for (let index = 0; index < arr2.length; index++) {\n            const element = arr2[index];\n            if (arr1.includes(element)) {\n                count = count + 1;\n            }\n        }\n        console.log(count, arr1.length);\n        return (count / arr1.length) * 100;\n    };\n\n    const deleteSobes = () => {\n        fetch(`http://localhost:8080/api/sobes/${item.id}`, {\n            method: 'DELETE',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n        }).then((result) => {\n            loadSobeses();\n        });\n    };\n\n    const editSobes = () => {\n        fetch(`http://localhost:8080/api/specialist/${selectedSpecialist}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n        })\n            .then((response) => {\n                return response.json();\n            })\n            .then((data) => {\n                if (abilitiesPercents(data.abilities.split(','), item.abilities.split(',')) < 80) {\n                    setError('Недостаточно навыков');\n                    return;\n                } else if (\n                    !(\n                        Number(data.time_start.split(':').join('')) <= Number(item.time_visit.split(':').join('')) &&\n                        Number(data.time_finish.split(':').join('')) >= Number(item.time_visit.split(':').join(''))\n                    )\n                ) {\n                    setError('Время визита не попадает во время приёма');\n                    return;\n                } else {\n                    fetch(`http://localhost:8080/api/specialist_sobeses/${selectedSpecialist}`, {\n                        method: 'GET',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    })\n                        .then((response) => {\n                            return response.json();\n                        })\n                        .then((data) => {\n                            if (!!data.find((el) => el.time_visit === item.time_visit)) {\n                                setError('Время уже занято');\n                                return;\n                            }\n                            const sobes = {\n                                id: item.id,\n                                fio: item.fio,\n                                time_visit: item.time_visit,\n                                abilities: item.abilities,\n                                specialist_id: selectedSpecialist,\n                            };\n                            fetch(`http://localhost:8080/api/sobes`, {\n                                method: 'PUT',\n                                body: JSON.stringify(sobes),\n                                headers: {\n                                    'Content-Type': 'application/json',\n                                },\n                            }).then((result) => {\n                                loadSpecialists();\n                            });\n                        });\n                }\n            });\n    };\n\n    return (\n        <CCol xs={4} className=\"pb-3\">\n            <CCard>\n                <CCardBody>\n                    <div>ФИО: {item.fio}</div>\n                    <div>Время визита: {item.time_visit}</div>\n                    <div>Навыки: {item.abilities}</div>\n                    <hr />\n                    <CFormSelect\n                        label=\"Куда перенести?\"\n                        onChange={(e) => {\n                            setSelectedSpecialist(e.target.value);\n                            setError('');\n                        }}>\n                        <option value=\"\"> </option>\n                        {specialists\n                            .filter((el) => el.id !== spec.id)\n                            .map((specialist) => {\n                                return (\n                                    <option key={specialist.id} value={specialist.id}>\n                                        {specialist.fio}\n                                    </option>\n                                );\n                            })}\n                    </CFormSelect>\n                    {!!error && <div className=\"text-danger\">{error}</div>}\n                    <CButton className=\"mt-2 me-2\" size=\"sm\" onClick={() => editSobes()}>\n                        Перенести\n                    </CButton>\n                    <CButton className=\"mt-2\" size=\"sm\" color=\"danger\" onClick={() => deleteSobes()}>\n                        Удалить\n                    </CButton>\n                </CCardBody>\n            </CCard>\n        </CCol>\n    );\n};\n\nexport default Sobes;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}