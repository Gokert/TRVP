{"ast":null,"code":"import{CButton,CCard,CCardBody,CCardHeader,CCol,CFormInput,CFormSelect,CFormLabel,CBadge}from'@coreui/react';import{useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const CreateSobes=_ref=>{let{specialistId,loadSobeses}=_ref;const[fio,setFio]=useState('');const[timeVisit,setTimeVisit]=useState('');const[abilities,setAbilities]=useState([]);const[error,setError]=useState('');const abilititesOptions=['Python','JavaScript','SQL','PHP'].filter(el=>!abilities.includes(el));const abilitiesPercents=(arr1,arr2)=>{let count=0;for(let index=0;index<arr2.length;index++){const element=arr2[index];if(arr1.includes(element)){count=count+1;}}console.log(count,arr1.length);return count/arr1.length*100;};const createSobes=()=>{fetch(\"http://localhost:8080/api/specialist/\".concat(specialistId),{method:'GET',headers:{'Content-Type':'application/json'}}).then(response=>{return response.json();}).then(data=>{if(abilitiesPercents(data.abilities.split(','),abilities)<80){setError('Недостаточно навыков');return;}else if(!(Number(data.time_start.split(':').join(''))<=Number(timeVisit.split(':').join(''))&&Number(data.time_finish.split(':').join(''))>=Number(timeVisit.split(':').join('')))){setError('Время визита не попадает во время приёма');return;}else{fetch(\"http://localhost:8080/api/specialist_sobeses/\".concat(specialistId),{method:'GET',headers:{'Content-Type':'application/json'}}).then(response=>{return response.json();}).then(data=>{if(!!data.find(el=>el.time_visit===timeVisit)){setError('Время уже занято');return;}const sob={fio:fio,time_visit:timeVisit,abilities:abilities.join(','),specialist_id:specialistId};fetch('http://localhost:8080/api/sobes',{method:'POST',body:JSON.stringify(sob),headers:{'Content-Type':'application/json'}}).then(result=>{loadSobeses();});setFio('');setTimeVisit('');setAbilities([]);});}});};return/*#__PURE__*/_jsx(CCol,{xs:4,children:/*#__PURE__*/_jsxs(CCard,{children:[/*#__PURE__*/_jsx(CCardHeader,{children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0435 \\u0441\\u043E\\u0431\\u0435\\u0441\\u0435\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsxs(CCardBody,{children:[/*#__PURE__*/_jsx(CFormLabel,{children:\"\\u0424\\u0418\\u041E\"}),/*#__PURE__*/_jsx(CFormInput,{value:fio,onChange:e=>{setError('');setFio(e.target.value);}}),/*#__PURE__*/_jsx(CFormLabel,{className:\"mt-2\",children:\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u0432\\u0438\\u0437\\u0438\\u0442\\u0430\"}),/*#__PURE__*/_jsx(CFormInput,{type:\"time\",value:timeVisit,onChange:e=>{setError('');setTimeVisit(e.target.value);}}),/*#__PURE__*/_jsx(CFormLabel,{className:\"mt-2\",children:\"\\u041D\\u0430\\u0432\\u044B\\u043A\\u0438\"}),/*#__PURE__*/_jsxs(CFormSelect,{value:1,onChange:e=>{setError('');setAbilities(()=>[...abilities,e.target.value]);},children:[/*#__PURE__*/_jsx(\"option\",{value:1}),abilititesOptions.map(item=>{return/*#__PURE__*/_jsx(\"option\",{value:item,children:item},item);})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-2\",children:abilities.map(ab=>{return/*#__PURE__*/_jsx(CBadge,{className:\"m-1\",color:\"secondary\",onClick:()=>setAbilities(abilities.filter(el=>el!==ab)),children:ab},ab);})}),!!error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:error}),/*#__PURE__*/_jsx(CButton,{className:\"text-center\",size:\"sm\",onClick:createSobes,children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})]})]})});};export default CreateSobes;","map":{"version":3,"names":["CButton","CCard","CCardBody","CCardHeader","CCol","CFormInput","CFormSelect","CFormLabel","CBadge","useState","jsx","_jsx","jsxs","_jsxs","CreateSobes","_ref","specialistId","loadSobeses","fio","setFio","timeVisit","setTimeVisit","abilities","setAbilities","error","setError","abilititesOptions","filter","el","includes","abilitiesPercents","arr1","arr2","count","index","length","element","console","log","createSobes","fetch","concat","method","headers","then","response","json","data","split","Number","time_start","join","time_finish","find","time_visit","sob","specialist_id","body","JSON","stringify","result","xs","children","value","onChange","e","target","className","type","map","item","ab","color","onClick","size"],"sources":["/home/andrey/githubGokert/TRVP/client/src/CreateSobes.js"],"sourcesContent":["import {\n    CButton,\n    CCard,\n    CCardBody,\n    CCardHeader,\n    CCol,\n    CFormInput,\n    CFormSelect,\n    CFormLabel,\n    CBadge,\n} from '@coreui/react';\nimport { useState } from 'react';\n\nconst CreateSobes = ({ specialistId, loadSobeses }) => {\n    const [fio, setFio] = useState('');\n    const [timeVisit, setTimeVisit] = useState('');\n    const [abilities, setAbilities] = useState([]);\n    const [error, setError] = useState('');\n    const abilititesOptions = ['Python', 'JavaScript', 'SQL', 'PHP'].filter((el) => !abilities.includes(el));\n\n    const abilitiesPercents = (arr1, arr2) => {\n        let count = 0;\n        for (let index = 0; index < arr2.length; index++) {\n            const element = arr2[index];\n            if (arr1.includes(element)) {\n                count = count + 1;\n            }\n        }\n        console.log(count, arr1.length);\n        return (count / arr1.length) * 100;\n    };\n\n    const createSobes = () => {\n        fetch(`http://localhost:8080/api/specialist/${specialistId}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n        })\n            .then((response) => {\n                return response.json();\n            })\n            .then((data) => {\n                if (abilitiesPercents(data.abilities.split(','), abilities) < 80) {\n                    setError('Недостаточно навыков');\n                    return;\n                } else if (\n                    !(\n                        Number(data.time_start.split(':').join('')) <= Number(timeVisit.split(':').join('')) &&\n                        Number(data.time_finish.split(':').join('')) >= Number(timeVisit.split(':').join(''))\n                    )\n                ) {\n                    setError('Время визита не попадает во время приёма');\n                    return;\n                } else {\n                    fetch(`http://localhost:8080/api/specialist_sobeses/${specialistId}`, {\n                        method: 'GET',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    })\n                        .then((response) => {\n                            return response.json();\n                        })\n                        .then((data) => {\n                            if (!!data.find((el) => el.time_visit === timeVisit)) {\n                                setError('Время уже занято');\n                                return;\n                            }\n                            const sob = {\n                                fio: fio,\n                                time_visit: timeVisit,\n                                abilities: abilities.join(','),\n                                specialist_id: specialistId,\n                            };\n                            fetch('http://localhost:8080/api/sobes', {\n                                method: 'POST',\n                                body: JSON.stringify(sob),\n                                headers: {\n                                    'Content-Type': 'application/json',\n                                },\n                            }).then((result) => {\n                                loadSobeses();\n                            });\n                            setFio('');\n                            setTimeVisit('');\n                            setAbilities([]);\n                        });\n                }\n            });\n    };\n\n    return (\n        <CCol xs={4}>\n            <CCard>\n                <CCardHeader>Создание собеседования</CCardHeader>\n                <CCardBody>\n                    <CFormLabel>ФИО</CFormLabel>\n                    <CFormInput\n                        value={fio}\n                        onChange={(e) => {\n                            setError('');\n                            setFio(e.target.value);\n                        }}\n                    />\n                    <CFormLabel className=\"mt-2\">Время визита</CFormLabel>\n                    <CFormInput\n                        type=\"time\"\n                        value={timeVisit}\n                        onChange={(e) => {\n                            setError('');\n                            setTimeVisit(e.target.value);\n                        }}\n                    />\n                    <CFormLabel className=\"mt-2\">Навыки</CFormLabel>\n                    <CFormSelect\n                        value={1}\n                        onChange={(e) => {\n                            setError('');\n                            setAbilities(() => [...abilities, e.target.value]);\n                        }}>\n                        <option value={1}></option>\n                        {abilititesOptions.map((item) => {\n                            return (\n                                <option key={item} value={item}>\n                                    {item}\n                                </option>\n                            );\n                        })}\n                    </CFormSelect>\n                    <div className=\"pt-2\">\n                        {abilities.map((ab) => {\n                            return (\n                                <CBadge\n                                    key={ab}\n                                    className=\"m-1\"\n                                    color=\"secondary\"\n                                    onClick={() => setAbilities(abilities.filter((el) => el !== ab))}>\n                                    {ab}\n                                </CBadge>\n                            );\n                        })}\n                    </div>\n                    {!!error && <div className=\"text-danger\">{error}</div>}\n                    <CButton className=\"text-center\" size=\"sm\" onClick={createSobes}>\n                        Создать\n                    </CButton>\n                </CCardBody>\n            </CCard>\n        </CCol>\n    );\n};\n\nexport default CreateSobes;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}